generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               Int        @id @unique @default(autoincrement())
  fullname         String     @db.VarChar(255)
  username         String?    @db.VarChar(255)
  email            String     @db.VarChar(255)
  password         String     @db.VarChar(255)
  updatePasswordAt DateTime?
  avatar           String?    @db.VarChar(255)
  country_code     String?    @db.VarChar(255)
  phone            String?    @db.VarChar(255)
  status           UserStatus @default(INACTIVE)
  role             Role       @default(USER)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  otps      OTP[]

  @@index([status, role])
}

enum Role {
  USER
  ADMIN
}

enum UserStatus {
  ACTIVE
  INACTIVE
  BANNED
}

model OTP {
  id        Int       @id @unique @default(autoincrement())
  code      String    @db.VarChar(255)
  site_id   String    @db.VarChar(255)
  email_id  String?   @db.VarChar(255)
  user_id   Int
  status    OTPStatus @default(PENDING)
  expiresAt DateTime?

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  user User @relation(fields: [user_id], references: [id])

  @@index([user_id, status])
}

enum OTPStatus {
  PENDING
  VERIFIED
  EXPIRED
}
